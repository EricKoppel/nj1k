@(ascent: AscentEntity)

@import views.RenderUtil._
@import utils.SecurityUtil._

@hero = {}
@main()(hero) {

	<script type="text/javascript">

    $(document).ready(function() {
    	$('#delete_ascent').click(function() {
    		if (confirm('@Messages("ascent.delete.prompt")')) {
	    		jsRoutes.controllers.AscentController.remove(@ascent.id).ajax({
	    			success: function(result) {
	    				window.location.href = "@routes.UsersController.showUser(ascent.climber.id)";
	    		    }
	    		});
    		}
    		return false;
    	});
    	
    	$('.delete_button').click(function() {
    		var container = $(this).parents(".img_container")[0];
    		jsRoutes.controllers.AscentDetailController.remove(container.id).ajax({
    			success: function(result) {
    		    	$(container).fadeOut();
    		    }
    		});
    		
    		return false;
    	});
    	
    	$('.ascent_img').click(function(e) {
    		var container = $(this).parents(".img_container")[0];
			window.open("/ascentDetail/" + container.id + "/show", '@ascent.mountain.name', 'width=1024, height=800px');
			return false;
		});
    });
    
	</script>
	  
	<div class="page-header">
		<h3>@Messages("ascent.title", ascent.mountain.name, ascent.climber.name, ascent.mountain.elevation)</h3>
	</div>
	
	<div class="row">
		<div class="col-md-8">
			<div class="panel panel-default">
				<div class="panel-heading">
					<h3 class="panel-title">@Messages("ascent.trip_report")</h3>
				</div>
				<div class="panel-body">
				@Html(formatText(ascent.trip_report))
				</div>
			</div>
		</div>
		<div class="col-md-4">
			<div class="panel panel-default">
				<div class="panel-heading">
					<h3 class="panel-title">@Messages("mountain.stats")</h3>
				</div>
				<div class="panel-body">
					<table class="table">
						<tr>
							<td>@Messages("ascent.summit")</td>
							<td><a href="@routes.MountainsController.showMountain(ascent.mountain.id)">@ascent.mountain.name</a></td>
						</tr>
						<tr>
							<td>@Messages("ascent.climber")</td>
							<td><a href="@routes.UsersController.showUser(ascent.climber.id)">@ascent.climber.name</a></td>
						</tr>
						<tr>
							<td>@Messages("ascent.date")</td>
							<td>@formatAscentDate(ascent.ascent_date)</td>
						</tr>
						<tr>
							<td>@Messages("ascent.successful")</td>
							<td>@renderBoolean(ascent.successful)</td>
						</tr>
					</table>
					
					@if(ownsAscent(ascent.id)) {
						<p><strong><a class="btn btn-small" href="@routes.AscentController.editForm(ascent.id)">@Messages("ascent.edit")</a></strong></p>
						<p><strong><a id="delete_ascent" class="btn btn-small" href="#">@Messages("ascent.delete")</a></strong></p>
					}
				</div>
			</div>
		</div>

	</div>
	@if(!ascent.ascentDetails.isEmpty()) {
		<div class="row">
			<div class="col-md-12">
				<div class="panel panel-default">
					<div class="panel-heading">
						<h3 class="panel-title">@Messages("ascent.report.pictures")</h3>
					</div>
					<div class="panel-body">
						@for(detail <- ascent.ascentDetails) {
							<div class="col-sm-6 col-md-2">
								<div class="thumbnail">
									<a href="#"><img alt="@detail.caption" height="200" width="200" src="@routes.AscentDetailController.getImage(detail.id)"></a>
									<div class="caption">
										<p>@detail.caption</p>
										@if(ownsAscent(ascent.id)) {
											<div style="position: absolute; left: 205px; top: -8px;">
									   			<a class="icon-remove delete_button" href="#"></a>
									   		</div>
									   	}
								   	</div>
								</div>
							</div>
						}
					</div>
				</div>
			</div>
		</div>
	}
}
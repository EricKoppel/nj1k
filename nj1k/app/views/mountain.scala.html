@(mountain: MountainEntity, ascents: List[AscentEntity], nhn: MountainEntity)
@import java.text.SimpleDateFormat

@main() {
    <script type="text/javascript" src="/routes.js"></script>
    <script src="@routes.Assets.at("javascripts/models/Mountain.js")" type="text/javascript"></script>
	<script src="@routes.Assets.at("javascripts/models/MountainDistanceModel.js")" type="text/javascript"></script>
	<script src="@routes.Assets.at("javascripts/views/MountainDistanceView.js")" type="text/javascript"></script>
	<script src="@routes.Assets.at("javascripts/views/MapView.js")" type="text/javascript"></script>
	<script src="@routes.Assets.at("javascripts/collections/MountainDistanceModelCollection.js")" type="text/javascript"></script>
	
	<script type="text/javascript">
		$(document).ready(function() {
		  $('#climbs').tableNav({
			    itemsPerPage: 10
		  });
		});

		$(function() {
			
			var AppView = Backbone.View.extend({
				el: '#radiusSearch',
				mapView: null,
			
				initialize: function() {
					this.mapView = new MapView({model: new Mountain({
						id: @mountain.id,
						name: '@mountain.name',
						latitude: @mountain.latitude,
						longitude: @mountain.longitude
					})}),
					this.distances = new MountainDistanceModelCollection();
					this.distances.collectionId = @mountain.id;
					this.distances.bind('add', this.addOne, this);
					this.distances.fetch({add: true});
				},
				
				addOne: function(m) {
					var mountainDistanceView = new MountainDistanceView({model: m});
					this.$el.append(mountainDistanceView.render().$el);
					this.mapView.addPoint(m.get("m2"));
				}
			});
			
			var App = new AppView();
		});
	</script>

	<div class="page-header">
		<h3>@mountain.name</h3>
    </div>
    <div class="row-fluid">
    
    	<div class="span4">
			<table id="mountain_info" class="table">
				<tr>
					<td>@Messages("mountain.elevation")</td>
					<td>@mountain.elevation</td>
				</tr>
				<tr>
					<td>@Messages("mountain.decimal_degrees")</td>
					<td>@mountain.latitude, @mountain.longitude</td>
				</tr>
				<tr>
					<td>@Messages("mountain.county")</td>
					<td>@mountain.county</td>
				</tr>		
				<tr>	
					<td>@Messages("mountain.ownership")</td>
					<td>@mountain.ownership</td>
				</tr>
				<tr>	
					<td>@Messages("mountain.owner")</td>
					<td>@mountain.owner</td>
				</tr>
				<tr>
					<td>@Messages("mountain.topo")</td>
					<td><a href="http://mapper.acme.com/?t=T&z=15&ll=@mountain.latitude,@mountain.longitude" target="_blank">Acme Mapper</a></td>
				</tr>
				<tr>
					<td>@Messages("mountain.nhn")</td>
					<td><a href="@routes.MountainsController.showMountain(nhn.id)">@nhn.name</a></td>
				</tr>
			</table>
		</div>
	
	    <div id="mountain_description" class="span8">
	    	@Html(mountain.description)
	    </div>

	</div>
	
	<h4>@Messages("mountain.others", mountain.name)</h4>
	
	<div class="row-fluid">
		<div class="span4">
			<table id="climbs" class="table table-striped">
			@for(a <- ascents) {
				<tr>
					<td><a href="@routes.AscentController.showTripReport(a.id)">@views.RenderUtil.formatAscentDate(a.ascent_date)</a></td>
					<td><a href="@routes.UsersController.showUser(a.climber.id)">@a.climber.name</a></td>
				</tr>
			}
			</table>
			<div class="pagination"></div>
		</div>
	</div>
	<h2>@Messages("radius.title", mountain.name)</h2>
	<table id="radiusSearch" class="table">
		<tr>
		</tr>
	</table>
	
	<div id="map_canvas"></div>
}